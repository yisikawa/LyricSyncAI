# LyricSync AI 操作マニュアル

このドキュメントでは、LyricSync AI のバックエンドおよびフロントエンドのセットアップと実行方法について説明します。

## 1. 事前準備

以下のツールがシステムにインストールされている必要があります。

- **Python 3.10以上** (バックエンド用)
- **Node.js 18以上** (フロントエンド用)
- **FFmpeg** (音声・動画処理用)
  - [FFmpeg公式サイト](https://ffmpeg.org/download.html)からダウンロードし、システムのPATHに含めてください。
  - バックエンド起動時に `C:\ffmpeg\bin` などの標準的なパスにあれば自動的に検出を試みます。

---

## 2. バックエンドのセットアップと起動

バックエンドは FastAPI を使用して構築されています。

### 手順
1. **ディレクトリに移動:**
   ```powershell
   cd backend
   ```

2. **仮想環境の作成と有効化:**
   ```powershell
   python -m venv venv
   .\venv\Scripts\activate
   ```

3. **依存関係のインストール:**
   ```powershell
   pip install -r requirements.txt
   ```
   ※ `faster-whisper` や `demucs` などの重いライブラリが含まれるため、インストールには数分かかる場合があります。

4. **サーバーの起動:**
   ```powershell
   uvicorn main:app --reload --port 8001
   ```
   - サーバーは `http://localhost:8001` で起動します。
   - フロントエンドとの通信のため、ポート番号は `8001` を指定してください。

---

## 3. フロントエンドのセットアップと起動

フロントエンドは React (Vite) を使用して構築されています。

### 手順
1. **ディレクトリに移動:**
   ```powershell
   cd frontend
   ```

2. **依存関係のインストール:**
   ```powershell
   npm install
   ```

3. **開発サーバーの起動:**
   ```powershell
   npm run dev
   ```
   - デフォルトでは `http://localhost:5173` で起動します。
   - ブラウザで上記URLにアクセスしてください。

---

## 4. 基本的な使用方法

1. **動画のアップロード:**
   - 画面上の「動画を選択」またはドラッグ＆ドロップで動画ファイルを選択します。
   - 動画が読み込まれると、バックエンドで音声分離などの前処理が開始されます。

2. **文字起こし:**
   - 「文字起こし開始」ボタンを押すと、Whisperを使用して歌詞が生成されます。
   - 生成された歌詞はエディタに表示され、タイミングの微調整が可能です。

3. **書き出し (Export):**
   - 編集が完了したら「Save & Export」ボタンを押すと、字幕が焼き付けられた動画が生成されます。

---

## トラブルシューティング

- **FFmpegが見つからない:**
  - FFmpegが正しくインストールされ、PATHが通っているか確認してください。
  - Windowsの場合、`C:\ffmpeg\bin\ffmpeg.exe` が存在することを確認してください。
- **CORSエラー:**
  - バックエンドが `8001` 番ポート以外で動いている場合、フロントエンドからのリクエストが拒否されることがあります。
- **メモリ不足:**
  - 音源分離（Demucs）や文字起こし（Whisper）はメモリを多く消費します。実行中にPCが重くなる場合は、他のアプリを閉じてみてください。
