# LyricSync AI 操作マニュアル

このドキュメントでは、LyricSync AI のバックエンドおよびフロントエンドのセットアップと実行方法について説明します。

## 1. 事前準備

以下のツールがシステムにインストールされている必要があります。

- **Python 3.10以上** (バックエンド用)
- **Node.js 18以上** (フロントエンド用)
- **FFmpeg** (音声・動画処理用)
  - [FFmpeg公式サイト](https://ffmpeg.org/download.html)からダウンロードし、システムのPATHに含めてください。
  - バックエンド起動時に `C:\ffmpeg\bin` などの標準的なパスにあれば自動的に検出を試みます。

---

## 2. バックエンドのセットアップと起動

バックエンドは FastAPI を使用して構築されています。

### 手順
1. **ディレクトリに移動:**
   ```powershell
   cd backend
   ```

2. **仮想環境の作成と有効化:**
   ```powershell
   python -m venv venv
   .\venv\Scripts\activate
   ```

3. **依存関係のインストール:**
   ```powershell
   pip install -r requirements.txt
   ```
   ※ `faster-whisper` や `demucs` などの重いライブラリが含まれるため、インストールには数分かかる場合があります。

4. **サーバーの起動:**
   ```powershell
   uvicorn main:app --reload --port 8001
   ```
   - サーバーは `http://localhost:8001` で起動します。
   - フロントエンドとの通信のため、ポート番号は `8001` を指定してください。

---

## 3. フロントエンドのセットアップと起動

フロントエンドは React (Vite) を使用して構築されています。

### 手順
1. **ディレクトリに移動:**
   ```powershell
   cd frontend
   ```

2. **依存関係のインストール:**
   ```powershell
   npm install
   ```

3. **開発サーバーの起動:**
   ```powershell
   npm run dev
   ```
   - デフォルトでは `http://localhost:5173` で起動します。
   - ブラウザで上記URLにアクセスしてください。

---

## 4. 基本的な使用方法

各工程は画面上部のタブ（ステップナビゲーション）で切り替えて進めます。
タブを切り替えることで、必要な処理が自動的に開始される設計になっています。

1. **動画選択 (Upload):**
   - 「動画選択」タブで動画ファイルを選択またはドラッグ＆ドロップします。
   - アップロード完了後、プレビューが表示されます。

2. **音声分離 (Vocal Separation):**
   - 「音声分離」タブをクリックすると、AIによるボーカル抽出処理が**自動的に開始**されます。
   - 処理完了まで数秒〜数分お待ちください。

3. **文字おこし (Transcription):**
   - 「文字おこし」タブをクリックすると、抽出された音声から文字起こし処理が**自動的に開始**されます。
   - 完了後、認識されたセグメントがリスト表示されます。

4. **字幕編集 (Edit):**
   - 「字幕編集」タブで、誤認識の修正やタイミング調整を行います。
   - プレビュー動画を見ながら歌詞を編集できます。

5. **動画書き出し (Export):**
   - 「動画書き出し」タブをクリックすると、編集した字幕を焼き付ける処理が**自動的に開始**されます。
   - 書き出し完了後、「動画を保存する 💾」ボタンが表示され、PCに保存できます。

---

## トラブルシューティング

- **FFmpegが見つからない:**
  - FFmpegが正しくインストールされ、PATHが通っているか確認してください。
  - Windowsの場合、`C:\ffmpeg\bin\ffmpeg.exe` が存在することを確認してください。
- **CORSエラー:**
  - バックエンドが `8001` 番ポート以外で動いている場合、フロントエンドからのリクエストが拒否されることがあります。
- **メモリ不足:**
  - 音源分離（Demucs）や文字起こし（Whisper）はメモリを多く消費します。実行中にPCが重くなる場合は、他のアプリを閉じてみてください。
